@model AracKiralamaPortal.ViewModels.RegisterViewModel

<link href="~/css/site.css" rel="stylesheet" />
<link href="~/css/sign.css" rel="stylesheet" />

<div class="login-page">
    <div class="login-card glass-card" id="card">
        <h2 class="login-title">Kayıt Ol</h2>

        <form id="registerForm" asp-action="Register" method="post">

            <div class="input-group">
                <input asp-for="Username" class="input-field" placeholder="Kullanıcı Adı" />
            </div>

            <div class="input-group">
                <input asp-for="Email" class="input-field" placeholder="Email" />
            </div>

            <div class="input-group password-group">
                <input asp-for="Password" type="password" class="input-field" id="passwordInput" placeholder="Şifre" />
                <span class="toggle-password" onclick="togglePwd('passwordInput', this)">
                    <i class="fa-solid fa-eye"></i>
                </span>
                <div class="strength-bar" id="strengthBar"></div>
                <div class="password-info" id="passwordInfo">
                    <ul>
                        <li id="u">1 Büyük harf</li>
                        <li id="l">1 Küçük harf</li>
                        <li id="d">1 Rakam</li>
                        <li id="s">1 Özel karakter</li>
                        <li id="len">Min 6 karakter</li>
                    </ul>
                </div>
            </div>

            <div class="input-group password-group">
                <input asp-for="ConfirmPassword" type="password" class="input-field" id="confirmInput" placeholder="Şifre Tekrar" />
                <span class="toggle-password" onclick="togglePwd('confirmInput', this)">
                    <i class="fa-solid fa-eye"></i>
                </span>
            </div>

            <button type="submit" class="btn-glass" id="submitBtn" disabled>Kayıt Ol</button>

        </form>
    </div>
</div>

@section Scripts {
    <script>
        const pwd = document.getElementById("passwordInput");
        const info = document.getElementById("passwordInfo");
        const bar = document.getElementById("strengthBar");
        const btn = document.getElementById("submitBtn");
        const card = document.getElementById("card");

        pwd.addEventListener("focus", () => info.style.display = "block");
        pwd.addEventListener("blur", () => info.style.display = "none");

        pwd.addEventListener("input", () => {
            const v = pwd.value;
            let score = 0;

            const rules = {
                u: /[A-Z]/.test(v),
                l: /[a-z]/.test(v),
                d: /[0-9]/.test(v),
                s: /[^A-Za-z0-9]/.test(v),
                len: v.length >= 6
            };

            Object.keys(rules).forEach(k => {
                document.getElementById(k).style.color = rules[k] ? "#00f5ff" : "#ff3860";
                if (rules[k]) score++;
            });

            bar.style.width = (score * 20) + "%";
            bar.style.background =
                score < 3 ? "#ff3860" :
                score < 5 ? "#ffa500" : "#00f5ff";

            btn.disabled = score < 5;
        });

        document.getElementById("registerForm").addEventListener("submit", e => {
            if (btn.disabled) {
                e.preventDefault();
                card.classList.add("shake");
                setTimeout(() => card.classList.remove("shake"), 300);
                return;
            }
            btn.innerHTML = "Kaydediliyor...";
            btn.disabled = true;
        });

        function togglePwd(id, el) {
            const input = document.getElementById(id);
            const icon = el.querySelector("i");
            if (input.type === "password") {
                input.type = "text";
                icon.classList.replace("fa-eye", "fa-eye-slash");
            } else {
                input.type = "password";
                icon.classList.replace("fa-eye-slash", "fa-eye");
            }
        }
    </script>
}
